"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_q2=self.webpackChunkphysical_ai_humanoid_robotics_q2||[]).push([[89],{5300(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"chapters/ros2-fundamentals","title":"Chapter 2 \u2014 ROS 2 Fundamentals (Nodes, Topics, Services, Actions)","description":"Learning Objectives","source":"@site/docs/chapters/02-ros2-fundamentals.md","sourceDirName":"chapters","slug":"/chapters/ros2-fundamentals","permalink":"/hackathon1/chapters/ros2-fundamentals","draft":false,"unlisted":false,"editUrl":"https://github.com/mohammadfaisalpirzada/hackathon1/edit/main/docs/chapters/02-ros2-fundamentals.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Chapter 2 \u2014 ROS 2 Fundamentals (Nodes, Topics, Services, Actions)"},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 1 \u2014 Physical AI / Embodied Intelligence","permalink":"/hackathon1/chapters/embodied-ai"},"next":{"title":"Chapter 3 \u2014 rclpy Patterns (Timers, QoS, Params, Composition)","permalink":"/hackathon1/chapters/rclpy-nodes"}}');var i=n(4848),t=n(8453);const l={title:"Chapter 2 \u2014 ROS 2 Fundamentals (Nodes, Topics, Services, Actions)"},a="Chapter 2 - ROS 2 Fundamentals (Nodes, Topics, Services, Actions)",c={},o=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Key Terms",id:"key-terms",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Mental model",id:"mental-model",level:3},{value:"How you debug ROS 2 systems (why the CLI matters)",id:"how-you-debug-ros-2-systems-why-the-cli-matters",level:3},{value:"Hands-on Lab: build all four primitives in one package (<code>rclpy</code>)",id:"hands-on-lab-build-all-four-primitives-in-one-package-rclpy",level:2},{value:"Lab Deliverable",id:"lab-deliverable",level:2},{value:"Assessment Item",id:"assessment-item",level:2},{value:"1) Create package",id:"1-create-package",level:3},{value:"2) Heartbeat publisher with a parameter",id:"2-heartbeat-publisher-with-a-parameter",level:3},{value:"3) Reset service",id:"3-reset-service",level:3},{value:"4) Register entry points + build",id:"4-register-entry-points--build",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Quick Quiz",id:"quick-quiz",level:2}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"chapter-2---ros-2-fundamentals-nodes-topics-services-actions",children:"Chapter 2 - ROS 2 Fundamentals (Nodes, Topics, Services, Actions)"})}),"\n",(0,i.jsx)(s.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Distinguish when to use topics vs services vs actions in robotics systems."}),"\n",(0,i.jsx)(s.li,{children:"Use ROS CLI introspection tools to diagnose \u201cwhat exists\u201d and \u201cwhat\u2019s happening now\u201d."}),"\n",(0,i.jsxs)(s.li,{children:["Implement a small ",(0,i.jsx)(s.code,{children:"rclpy"})," package containing a publisher, a service, and a parameter."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"key-terms",children:"Key Terms"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"node, topic, service, action, parameter, message type, introspection"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"ROS 2 Humble installed and sourced."}),"\n",(0,i.jsxs)(s.li,{children:["You can build a workspace with ",(0,i.jsx)(s.code,{children:"colcon"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"concepts",children:"Concepts"}),"\n",(0,i.jsx)(s.h3,{id:"mental-model",children:"Mental model"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Node"}),": a process with ROS interfaces (publish/subscribe/service/action/params)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Topic"}),": streaming data (pub/sub). Example: ",(0,i.jsx)(s.code,{children:"/camera/image_raw"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Service"}),": request/response (RPC). Example: \u201creset\u201d."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Action"}),": long-running goal with feedback + result. Example: \u201cnavigate to pose\u201d."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Parameters"}),": runtime configuration (typed key/value)."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"how-you-debug-ros-2-systems-why-the-cli-matters",children:"How you debug ROS 2 systems (why the CLI matters)"}),"\n",(0,i.jsx)(s.p,{children:"Start with observability:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 node list\nros2 topic list\nros2 topic info /some/topic -v\nros2 topic echo /some/topic --once\nros2 interface show geometry_msgs/msg/Twist\n"})}),"\n",(0,i.jsxs)(s.h2,{id:"hands-on-lab-build-all-four-primitives-in-one-package-rclpy",children:["Hands-on Lab: build all four primitives in one package (",(0,i.jsx)(s.code,{children:"rclpy"}),")"]}),"\n",(0,i.jsx)(s.p,{children:"We'll create:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["a topic publisher (",(0,i.jsx)(s.code,{children:"/q2/heartbeat"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:["a service (",(0,i.jsx)(s.code,{children:"/q2/reset_counter"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:["a parameter (",(0,i.jsx)(s.code,{children:"publish_rate_hz"}),")"]}),"\n",(0,i.jsx)(s.li,{children:"an action client (Nav2 later; here we stub the shape)"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"lab-deliverable",children:"Lab Deliverable"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["A package ",(0,i.jsx)(s.code,{children:"q2_ros2_basics"})," that publishes ",(0,i.jsx)(s.code,{children:"/q2/heartbeat"})," and serves ",(0,i.jsx)(s.code,{children:"/q2/reset_counter"}),", verifiable via ",(0,i.jsx)(s.code,{children:"ros2 topic echo"})," and ",(0,i.jsx)(s.code,{children:"ros2 service call"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"assessment-item",children:"Assessment Item"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Quiz: given three tasks (telemetry stream, reset command, \u201cnavigate to pose\u201d), choose topic/service/action and justify."}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"1-create-package",children:"1) Create package"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/q2_ws/src\nros2 pkg create q2_ros2_basics --build-type ament_python --dependencies rclpy std_msgs std_srvs\n"})}),"\n",(0,i.jsx)(s.h3,{id:"2-heartbeat-publisher-with-a-parameter",children:"2) Heartbeat publisher with a parameter"}),"\n",(0,i.jsxs)(s.p,{children:["Create ",(0,i.jsx)(s.code,{children:"~/q2_ws/src/q2_ros2_basics/q2_ros2_basics/heartbeat.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'import time\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass Heartbeat(Node):\n    def __init__(self) -> None:\n        super().__init__("heartbeat")\n        self.pub = self.create_publisher(String, "/q2/heartbeat", 10)\n        self.rate_hz = float(self.declare_parameter("publish_rate_hz", 2.0).value)\n        self.timer = self.create_timer(1.0 / self.rate_hz, self.on_tick)\n        self.counter = 0\n\n    def on_tick(self) -> None:\n        self.counter += 1\n        msg = String()\n        msg.data = f"{self.counter} @ {time.time():.3f}"\n        self.pub.publish(msg)\n\n\ndef main() -> None:\n    rclpy.init()\n    rclpy.spin(Heartbeat())\n\n\nif __name__ == "__main__":\n    main()\n'})}),"\n",(0,i.jsx)(s.h3,{id:"3-reset-service",children:"3) Reset service"}),"\n",(0,i.jsxs)(s.p,{children:["Create ",(0,i.jsx)(s.code,{children:"~/q2_ws/src/q2_ros2_basics/q2_ros2_basics/reset_service.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'import rclpy\nfrom rclpy.node import Node\nfrom std_srvs.srv import Trigger\n\n\nclass ResetService(Node):\n    def __init__(self) -> None:\n        super().__init__("reset_service")\n        self.counter = 0\n        self.srv = self.create_service(Trigger, "/q2/reset_counter", self.on_reset)\n\n    def on_reset(self, request: Trigger.Request, response: Trigger.Response) -> Trigger.Response:\n        self.counter = 0\n        response.success = True\n        response.message = "Counter reset to 0"\n        return response\n\n\ndef main() -> None:\n    rclpy.init()\n    rclpy.spin(ResetService())\n\n\nif __name__ == "__main__":\n    main()\n'})}),"\n",(0,i.jsx)(s.h3,{id:"4-register-entry-points--build",children:"4) Register entry points + build"}),"\n",(0,i.jsxs)(s.p,{children:["Edit ",(0,i.jsx)(s.code,{children:"~/q2_ws/src/q2_ros2_basics/setup.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'entry_points={\n    "console_scripts": [\n        "heartbeat = q2_ros2_basics.heartbeat:main",\n        "reset_service = q2_ros2_basics.reset_service:main",\n    ],\n},\n'})}),"\n",(0,i.jsx)(s.p,{children:"Build:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/q2_ws\ncolcon build --symlink-install\nsource ~/q2_ws/install/setup.bash\n"})}),"\n",(0,i.jsx)(s.p,{children:"Run:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Terminal A\nros2 run q2_ros2_basics heartbeat --ros-args -p publish_rate_hz:=5.0\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Terminal B\nros2 run q2_ros2_basics reset_service\n"})}),"\n",(0,i.jsx)(s.p,{children:"Inspect + call:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'ros2 topic echo /q2/heartbeat --once\nros2 service call /q2/reset_counter std_srvs/srv/Trigger "{}"\n'})}),"\n",(0,i.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ModuleNotFoundError"})," when running a node","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["You forgot to rebuild or source: ",(0,i.jsx)(s.code,{children:"colcon build --symlink-install && source install/setup.bash"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Service call hangs","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Node isn\u2019t running, or you called the wrong service type. Check: ",(0,i.jsx)(s.code,{children:"ros2 service list -t"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Parameter doesn\u2019t change behavior","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["You used ",(0,i.jsx)(s.code,{children:"declare_parameter"})," but cached the old value; implement parameter callbacks if you\nwant dynamic reconfigure."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"quick-quiz",children:"Quick Quiz"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"When should you choose an action over a service?"}),"\n",(0,i.jsx)(s.li,{children:"What are parameters used for, and what are they not good for?"}),"\n",(0,i.jsx)(s.li,{children:"Which CLI commands do you run first when \u201cit doesn\u2019t work\u201d?"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,s,n){n.d(s,{R:()=>l,x:()=>a});var r=n(6540);const i={},t=r.createContext(i);function l(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);