"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_q2=self.webpackChunkphysical_ai_humanoid_robotics_q2||[]).push([[5365],{8453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var s=i(6540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}},9233(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"chapters/urdf-tf2","title":"Chapter 4 \u2014 URDF/Xacro + TF2 (Robot Model and Frames)","description":"Learning Objectives","source":"@site/docs/chapters/04-urdf-tf2.md","sourceDirName":"chapters","slug":"/chapters/urdf-tf2","permalink":"/physical-ai-humanoid-robotics-q2/chapters/urdf-tf2","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Chapter 4 \u2014 URDF/Xacro + TF2 (Robot Model and Frames)"},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 3 \u2014 rclpy Patterns (Timers, QoS, Params, Composition)","permalink":"/physical-ai-humanoid-robotics-q2/chapters/rclpy-nodes"},"next":{"title":"Chapter 5 \u2014 Gazebo Simulation (Classic) + Diff Drive","permalink":"/physical-ai-humanoid-robotics-q2/chapters/gazebo-simulation"}}');var r=i(4848),l=i(8453);const a={title:"Chapter 4 \u2014 URDF/Xacro + TF2 (Robot Model and Frames)"},o="Chapter 4 - URDF/Xacro + TF2 (Robot Model and Frames)",t={},d=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Key Terms",id:"key-terms",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Concepts",id:"concepts",level:2},{value:"URDF vs Xacro",id:"urdf-vs-xacro",level:3},{value:"TF2 (why frames are a first-class problem)",id:"tf2-why-frames-are-a-first-class-problem",level:3},{value:"Hands-on Lab: build a minimal &quot;minibot&quot; URDF and visualize in RViz",id:"hands-on-lab-build-a-minimal-minibot-urdf-and-visualize-in-rviz",level:2},{value:"1) Create a description package",id:"1-create-a-description-package",level:3},{value:"2) Create a Xacro file",id:"2-create-a-xacro-file",level:3},{value:"3) Add a launch file to publish robot_description + TF",id:"3-add-a-launch-file-to-publish-robot_description--tf",level:3},{value:"4) Wire CMake install rules",id:"4-wire-cmake-install-rules",level:3},{value:"5) Build and run",id:"5-build-and-run",level:3},{value:"Lab Deliverable",id:"lab-deliverable",level:2},{value:"Assessment Item",id:"assessment-item",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Quick Quiz",id:"quick-quiz",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-4---urdfxacro--tf2-robot-model-and-frames",children:"Chapter 4 - URDF/Xacro + TF2 (Robot Model and Frames)"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Build a minimal URDF/Xacro robot model with links and joints."}),"\n",(0,r.jsxs)(n.li,{children:["Explain common TF frame conventions (",(0,r.jsx)(n.code,{children:"map"}),", ",(0,r.jsx)(n.code,{children:"odom"}),", ",(0,r.jsx)(n.code,{children:"base_link"}),", sensor frames)."]}),"\n",(0,r.jsx)(n.li,{children:"Visualize the robot model and frames in RViz and diagnose TF issues."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-terms",children:"Key Terms"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"URDF, Xacro, link, joint, TF2, transform, frame, robot_state_publisher"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["ROS 2 Humble Desktop installed (includes ",(0,r.jsx)(n.code,{children:"rviz2"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"Install helpers (if missing):"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install -y ros-humble-xacro ros-humble-robot-state-publisher ros-humble-joint-state-publisher-gui\n"})}),"\n",(0,r.jsx)(n.h2,{id:"concepts",children:"Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"urdf-vs-xacro",children:"URDF vs Xacro"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"URDF"}),": XML robot description; links + joints + visuals/collisions/inertials."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Xacro"}),": \u201cURDF with macros\u201d; use it to avoid copy/paste and parameterize dimensions."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"tf2-why-frames-are-a-first-class-problem",children:"TF2 (why frames are a first-class problem)"}),"\n",(0,r.jsx)(n.p,{children:"Your robot is many coordinate frames. TF2 answers:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u201cWhere is ",(0,r.jsx)(n.code,{children:"base_link"})," relative to ",(0,r.jsx)(n.code,{children:"map"})," right now?\u201d"]}),"\n",(0,r.jsx)(n.li,{children:"\u201cHow do I transform a point from camera frame to base frame?\u201d"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Common frames you\u2019ll see:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"map -> odom -> base_link -> base_footprint -> sensors (camera_link, lidar_link, ...)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hands-on-lab-build-a-minimal-minibot-urdf-and-visualize-in-rviz",children:'Hands-on Lab: build a minimal "minibot" URDF and visualize in RViz'}),"\n",(0,r.jsx)(n.h3,{id:"1-create-a-description-package",children:"1) Create a description package"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/q2_ws/src\nros2 pkg create q2_minibot_description --build-type ament_cmake\nmkdir -p q2_minibot_description/urdf q2_minibot_description/launch\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-create-a-xacro-file",children:"2) Create a Xacro file"}),"\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"~/q2_ws/src/q2_minibot_description/urdf/minibot.urdf.xacro"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot xmlns:xacro="http://ros.org/wiki/xacro" name="minibot">\n  <xacro:property name="wheel_r" value="0.05"/>\n  <xacro:property name="wheel_sep" value="0.30"/>\n\n  <link name="base_link">\n    <visual>\n      <geometry><box size="0.35 0.25 0.12"/></geometry>\n      <material name="blue"><color rgba="0.15 0.39 0.92 1"/></material>\n    </visual>\n    <collision>\n      <geometry><box size="0.35 0.25 0.12"/></geometry>\n    </collision>\n    <inertial>\n      <mass value="5.0"/>\n      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>\n    </inertial>\n  </link>\n\n  <link name="left_wheel_link">\n    <visual><geometry><cylinder length="0.02" radius="${wheel_r}"/></geometry></visual>\n  </link>\n  <joint name="left_wheel_joint" type="continuous">\n    <parent link="base_link"/>\n    <child link="left_wheel_link"/>\n    <origin xyz="0 ${wheel_sep/2} -0.05" rpy="0 1.5708 0"/>\n    <axis xyz="0 0 1"/>\n  </joint>\n\n  <link name="right_wheel_link">\n    <visual><geometry><cylinder length="0.02" radius="${wheel_r}"/></geometry></visual>\n  </link>\n  <joint name="right_wheel_joint" type="continuous">\n    <parent link="base_link"/>\n    <child link="right_wheel_link"/>\n    <origin xyz="0 -${wheel_sep/2} -0.05" rpy="0 1.5708 0"/>\n    <axis xyz="0 0 1"/>\n  </joint>\n\n  <link name="lidar_link">\n    <visual><geometry><cylinder length="0.03" radius="0.04"/></geometry></visual>\n  </link>\n  <joint name="lidar_joint" type="fixed">\n    <parent link="base_link"/>\n    <child link="lidar_link"/>\n    <origin xyz="0.1 0 0.08" rpy="0 0 0"/>\n  </joint>\n</robot>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-add-a-launch-file-to-publish-robot_description--tf",children:"3) Add a launch file to publish robot_description + TF"}),"\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"~/q2_ws/src/q2_minibot_description/launch/view_minibot.launch.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom launch.substitutions import Command, PathJoinSubstitution\nfrom launch_ros.substitutions import FindPackageShare\n\n\ndef generate_launch_description():\n    xacro_file = PathJoinSubstitution(\n        [FindPackageShare("q2_minibot_description"), "urdf", "minibot.urdf.xacro"]\n    )\n    robot_description = {"robot_description": Command(["xacro ", xacro_file])}\n\n    return LaunchDescription(\n        [\n            Node(\n                package="robot_state_publisher",\n                executable="robot_state_publisher",\n                parameters=[robot_description],\n            ),\n            Node(\n                package="joint_state_publisher_gui",\n                executable="joint_state_publisher_gui",\n            ),\n            Node(package="rviz2", executable="rviz2"),\n        ]\n    )\n'})}),"\n",(0,r.jsx)(n.h3,{id:"4-wire-cmake-install-rules",children:"4) Wire CMake install rules"}),"\n",(0,r.jsxs)(n.p,{children:["Edit ",(0,r.jsx)(n.code,{children:"~/q2_ws/src/q2_minibot_description/CMakeLists.txt"})," (add at end):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cmake",children:"install(DIRECTORY launch urdf\n  DESTINATION share/${PROJECT_NAME}\n)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-build-and-run",children:"5) Build and run"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/q2_ws\ncolcon build --symlink-install\nsource ~/q2_ws/install/setup.bash\nros2 launch q2_minibot_description view_minibot.launch.py\n"})}),"\n",(0,r.jsx)(n.p,{children:"In RViz:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add \u201cRobotModel\u201d"}),"\n",(0,r.jsxs)(n.li,{children:['Set "Fixed Frame" to ',(0,r.jsx)(n.code,{children:"base_link"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"lab-deliverable",children:"Lab Deliverable"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A package ",(0,r.jsx)(n.code,{children:"q2_minibot_description"})," whose robot renders in RViz with a coherent TF tree and consistent fixed frame selection."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"assessment-item",children:"Assessment Item"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Quiz: explain why ",(0,r.jsx)(n.code,{children:"map -> odom -> base_link"})," is preferred over ",(0,r.jsx)(n.code,{children:"map -> base_link"})," directly in most navigation setups."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"xacro: command not found"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Install: ",(0,r.jsx)(n.code,{children:"sudo apt install ros-humble-xacro"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Robot doesn\u2019t show up in RViz","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You didn\u2019t add \u201cRobotModel\u201d, or \u201cFixed Frame\u201d is wrong."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["TF tree is confusing","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use: ",(0,r.jsx)(n.code,{children:"ros2 run tf2_tools view_frames"})," (generates a PDF in the current directory)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-quiz",children:"Quick Quiz"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Why use ",(0,r.jsx)(n.code,{children:"odom -> base_link"})," instead of ",(0,r.jsx)(n.code,{children:"map -> base_link"})," directly?"]}),"\n",(0,r.jsx)(n.li,{children:"What is the difference between a fixed joint and a continuous joint?"}),"\n",(0,r.jsx)(n.li,{children:"What ROS node turns URDF joint states into TF transforms?"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);